# SplitBySRT

REAPER 用 Lua スクリプト。  
字幕ファイル（.srt）を読み込んで、対応する音声アイテムを自動で分割・話者別トラックに配置します。

---

## 主な機能

- `.srt` 字幕ファイルに対応
- 字幕のタイミングでReaper上の音声メディアアイテムを自動分割し、アイテム名に字幕の内容を反映させる
- 括弧で囲まれた発話者（例: `（人物A）こんにちは`）を検出し、話者ごとに別トラックへ分類
- コンフィグファイルによるカスタマイズ対応（改行の変換・バッファ調整など）

---

## 使い方

### 1. スクリプトの準備

1. このリポジトリの`SplitBySRT.lua` と `config.ini`をダウンロードし、同じフォルダに配置します。
2. REAPER の「アクション」メニューから「スクリプトをインポート」し、`SplitBySRT.lua` を登録します。

---

### 2. REAPERでの操作手順

1. **音声アイテムを選択**  
   字幕と一致させたい元音声（または動画）アイテムを選択しておきます。

2. **スクリプトを実行**  
   アクションリストから `SplitBySRT` を実行します。

3. **SRTファイルを選択**  
   表示されるダイアログで `.srt` ファイルを指定します。

4. **処理が実行される**  
   - 字幕に対応するタイミングで元の音声が分割（または複製）されます。
   - 字幕に含まれる発話者名（例：`（人物A）`）に応じて、アイテムが話者ごとの新しいトラックに振り分けられます。
   - 発話者がない字幕はタイトルなしの同じトラックに振り分けられます。
   - アイテム名には字幕の内容がそのまま付与されます。

5. **任意の形式でエクスポート**
   - Reaperでレンダリングする際に「選択メディアアイテム」を指定すると、選択したアイテムをまとめて音声ファイルに出力することができます。
   - 話者ごとにトラック分けしていると、ファイル名の命名規則をカスタマイズすることで出力ファイルのフォルダ分けなどができます。
   - 例えば、ファイル名を`$track\$itemnumber_$item`とすると、`人物A`のフォルダの中に`01_こんにちは.wav` という形式で音声ファイルが作成されます。

---

### 3. 設定変更（オプション）

`config.ini` を編集することで動作をカスタマイズできます：

```ini
# 字幕内の改行をどう置換するか（例：空白、スラッシュなど）
newline_replace =  

# 字幕の先頭・末尾に何秒追加するか（浮動小数点, 秒単位）
padding_start = 0.03
padding_end   = 0.03
```

---

### 補足

- 複数の音声アイテムを選択している場合、それらが **同一トラック上にある必要があります**。
- トラックの順番は、元トラックの直下に話者別トラックが追加される形で管理されます。
- 一つの字幕の中に複数人の発話者情報が含まれている場合は、一人目に出てきた人物のトラックに配置されます。

---


## ファイル構成

```
SplitBySRT/
├─ SplitBySRT.lua         # メインスクリプト
├─ config.ini             # 設定ファイル（任意）
└─ README.md              # このファイル
```

---

## 開発者向けメモ

- Lua 5.3 互換

---

## ライセンス

MIT License
